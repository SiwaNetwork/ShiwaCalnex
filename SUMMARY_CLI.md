# Добавленная функциональность CLI для выбора PTP устройств

## Что было добавлено

### 1. Расширенный CLI интерфейс (`CLI_INTERFACE.c`)
- ✅ Автоматическое сканирование и обнаружение всех PTP устройств в системе
- ✅ Упрощенный выбор устройства через опцию `--ptp N`
- ✅ Команда `--list-devices` для просмотра доступных устройств
- ✅ Проверка доступности устройств (права доступа)
- ✅ Автоматический выбор первого доступного устройства при отсутствии указания
- ✅ Передача остальных параметров основной программе OpenTimeInstrument

### 2. Удобный скрипт-обертка (`ptp-cli`)
- ✅ Быстрые команды: `list`, `info`, `time`, `sync`
- ✅ Автоматическая проверка прав root
- ✅ Подробная справка с примерами
- ✅ Проверка существования необходимых файлов

### 3. Система сборки (`Makefile_CLI`)
- ✅ Компиляция CLI интерфейса и основной программы
- ✅ Установка в систему (в `/usr/local/bin/`)
- ✅ Автоматическое тестирование
- ✅ Удаление при деинсталляции

### 4. Документация
- ✅ Подробная документация в `CLI_README.md`
- ✅ Примеры использования
- ✅ Решение типичных проблем

## Новые возможности выбора устройств

### До изменений:
```bash
# Только базовый выбор устройства
./OpenTimeInstrument -d /dev/ptp0 -g
```

### После изменений:
```bash
# Список доступных устройств
./ptp-cli list
./cli_interface --list-devices

# Упрощенный выбор по номеру
./ptp-cli info 0
./cli_interface --ptp 0 -g

# Быстрые команды
./ptp-cli time 0    # получить время
./ptp-cli sync 0    # синхронизировать
./ptp-cli info 0    # информация о устройстве

# Автоматический выбор первого доступного устройства
./cli_interface -g  # выберет первое доступное устройство
```

## Пример вывода

### Список устройств:
```
$ ./ptp-cli list
Доступные PTP устройства:
Устройство      Номер        Статус
----------      -----        ------
/dev/ptp0       0            Доступно
/dev/ptp1       1            Недоступно (требуются права root)
```

### Информация об устройстве:
```
$ sudo ./ptp-cli info 0
Информация о PTP устройстве 0:
Используется PTP устройство: /dev/ptp0
capabilities:
  0 maximum frequency adjustment (ppb)
  0 programmable alarms
  0 external time stamp channels
  0 programmable periodic signals
  0 pulse per second
  0 programmable pins
  1 cross timestamping
```

### Получение времени:
```
$ sudo ./ptp-cli time 0
Время с PTP устройства 0:
Используется PTP устройство: /dev/ptp0
clock time: 1752652834.890381327 or Wed Jul 16 08:00:34 2025
```

## Файловая структура

```
├── CLI_INTERFACE.c      # Основной CLI код
├── ptp-cli             # Удобный скрипт-обертка
├── Makefile_CLI        # Makefile для сборки
├── CLI_README.md       # Подробная документация
└── SUMMARY_CLI.md      # Этот обзор
```

## Установка и использование

```bash
# Сборка
make -f Makefile_CLI all

# Тестирование
./ptp-cli list
sudo ./ptp-cli info 0

# Установка в систему
sudo make -f Makefile_CLI install

# После установки можно использовать глобально:
ptp-cli list
sudo ptp-cli time 0
```

## Преимущества нового CLI

1. **Удобство**: Не нужно помнить пути к устройствам
2. **Безопасность**: Автоматическая проверка прав доступа
3. **Обнаружение**: Автоматический поиск всех PTP устройств
4. **Простота**: Быстрые команды для частых операций
5. **Совместимость**: Полная совместимость с оригинальным интерфейсом